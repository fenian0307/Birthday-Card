<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>互動蠟燭</title>
    <style>
        /* 基礎樣式：確保全螢幕且黑色背景 */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #000;
            font-family: sans-serif;
        }

        #candle-container {
            position: relative;
            width: 100%;
            height: 100vh;
            cursor: pointer;
        }

        video {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* 居中對齊 */
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            object-fit: cover;
            transition: opacity 0.8s ease;
        }

        /* 初始狀態 */
        #burningVideo { z-index: 10; opacity: 1; }
        #extinguishVideo { z-index: 5; opacity: 0; }

        /* 除錯提示框：只在出錯時顯示 */
        #error-msg {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            text-align: center;
            z-index: 100;
            background: rgba(255,0,0,0.5);
            padding: 20px;
            display: none;
            pointer-events: none;
        }
    </style>
</head>
<body>

<div id="error-msg">檔案讀取失敗，請檢查檔名是否為 burning.mp4</div>

<div id="candle-container">
    <video id="burningVideo" loop muted playsinline autoplay>
        <source src="burning.mp4" type="video/mp4">
    </video>

    <video id="extinguishVideo" muted playsinline>
        <source src="extinguish.mp4" type="video/mp4">
    </video>
</div>

<script>
    const burning = document.getElementById('burningVideo');
    const extinguish = document.getElementById('extinguishVideo');
    const errorMsg = document.getElementById('error-msg');
    let isFinished = false;

    // --- 自動偵測機制 ---
    function checkFile(videoElement) {
        videoElement.onerror = () => {
            errorMsg.style.display = 'block';
            errorMsg.innerHTML = `找不到影片檔：${videoElement.querySelector('source').getAttribute('src')}<br>請確認檔案與 index.html 放在同一個資料夾。`;
        };
    }
    checkFile(burning);
    checkFile(extinguish);

    // --- 互動邏輯 ---
    document.getElementById('candle-container').addEventListener('click', function() {
        if (isFinished) return;
        
        // 1. 確保影片已準備好
        extinguish.play().then(() => {
            isFinished = true;
            // 2. 切換動畫
            burning.style.opacity = '0';
            extinguish.style.opacity = '1';
            extinguish.style.zIndex = '20';
            
            // 3. 播放完畢後停止
            extinguish.onended = () => {
                console.log("熄滅動畫結束");
            };
        }).catch(err => {
            console.log("等待使用者互動中...");
        });
    });

    // 處理部分瀏覽器禁止自動播放的問題
    window.addEventListener('load', () => {
        burning.play().catch(() => {
            console.log("請點擊畫面開始播放影片");
        });
    });
</script>

</body>
</html>